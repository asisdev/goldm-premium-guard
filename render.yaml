services:
  - type: web
    name: goldm-premium-guard
    env: python
    plan: free
    autoDeploy: true

    buildCommand: |
      pip install --upgrade pip
      pip install -r requirements.txt
      pip install "git+https://github.com/Kotak-Neo/Kotak-neo-api-v2.git@v2.0.1#egg=neo_api_client"

    startCommand: uvicorn app:app --host 0.0.0.0 --port $PORT

    healthCheckPath: /health
    healthCheckTimeout: 100

    envVars:
      # ---- Strategy knobs (keep defaults or change in UI) ----
      - key: LOOKBACK_MIN
        value: "5"
      - key: UNDER_MOVE_PCT
        value: "0.20"
      - key: OPT_STALE_PCT
        value: "0.10"
      - key: TOP_K
        value: "5"
      - key: RUN_INTERVAL_S
        value: "60"
      - key: ALERT_SILENCE_MIN
        value: "5"

      # ---- Tradetron (fill these in Render UI) ----
      - key: TT_WEBHOOK_URL   # e.g., https://api.tradetron.tech/api
        sync: false           # <<<CHANGE_ME: TRADETRON_WEBHOOK_URL>>> (set in UI)
      - key: TT_API_TOKEN
        sync: false           # <<<CHANGE_ME: TRADETRON_API_TOKEN>>> (set in UI)

      # ---- Kotak Neo (fill in Render UI; do NOT commit real values) ----
      - key: NEO_CONSUMER_KEY
        sync: false           # <<<CHANGE_ME: KOTAK_CONSUMER_KEY>>> (set in UI)
      - key: NEO_USERNAME
        sync: false           # <<<CHANGE_ME: KOTAK_LOGIN_USER_OR_MOBILE>>> (set in UI)
      - key: NEO_PASSWORD
        sync: false           # <<<CHANGE_ME: KOTAK_LOGIN_PASSWORD>>> (set in UI)
      - key: NEO_TOTP_SECRET
        sync: false           # <<<CHANGE_ME: KOTAK_TOTP_SECRET_BASE32>>> (set in UI)

      # Optional override (usually leave default)
      - key: NEO_BASE_URL
        value: "https://napi.kotaksecurities.com"  # documented dev portal host [3](https://tradenvesteasy.com/fetch-live-option-chain-using-kotak-neo-api/)
